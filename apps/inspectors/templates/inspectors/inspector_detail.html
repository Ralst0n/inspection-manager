{% extends 'base_nav.html' %}

{% block headers %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.css">
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.js"></script>
{% endblock %}

{% block title %} {{ inspector.first_name }} {{ inspector.last_name }} {% endblock %}
{% block styles %}
  .container {
    width: 90%;
  }
  .table-container{
    width: 100%;
  }
  .table-container *{
    margin: 10px auto;
    text-align: center;
  }

  .table-container table{

  }
  #work-history {
    border: 1px dotted red;
  }
{% endblock %}

{% block content %}
<h1 class="text-center"> {{ inspector.first_name }} {{inspector.last_name}} ({{inspector.classification}})</h1>



<div class="offset-sm-3 col-sm-4">
  <h5>Contact Information</h5>
  <p><strong>Email: </strong>{{ inspector.email }}</p>
  <p><strong>Phone: </strong>
    {% if inspector.phone_number %}
        ({{ inspector.phone_number|slice:":3"  }}) {{ inspector.phone_number|slice:"3:6"}}-{{ inspector.phone_number|slice:"6:"}}
    {% else %}
        Unlisted
    {% endif %}
  </p>
  <p><strong>Address: </strong>{{ inspector.address }} {{ inspector.location }}</p>

</div>
<div class="col-sm-4">
  <h5>Project information</h5>
  <p><strong>Current Project: </strong>
    {% if inspector.get_current_project %}
    {% for project in inspector.get_current_project %}<a href="{{project.get_absolute_url}}">{{project.penndot_number}}</a> ({{project.prudent_number}}) {% endfor %}
    {% elif inspector.is_employee %}
    <span class="text-danger">Unemployed</span>
    {% else %}
      N/A
    {% endif %}
  </p>
  <p><strong>Name:</strong>
    {% if inspector.get_current_project %}
    {% for project in inspector.get_current_project %}<a href="{{project.get_absolute_url}}">{{project.name}}</a>{% endfor %}
    {% elif inspector.is_employee %}
    <span class="text-danger">None</span>
    {% else %}
    N/A
    {% endif %}
  </p>
  <p><strong>Devices: </strong>
    {% if inspector.get_equipment_list %}
      {% for device in inspector.get_equipment_list %}<a href="{{ device.item.get_absolute_url }}"> {{device.item.name}} ({{device.item.device}})</a></span> {% if not forloop.last %} | {% endif %} {% endfor %}</p>
    {% else %}
      None
    {% endif %}
</div>




{% if inspector.is_employee %}
<div id="certs-table" class="table-container">
  <h2>Cert Expiration Dates</h2>

    <table class="table">
      <thead>
        <th>NICET</th>
        <th>PennDot Bituminous</th>
        <th>NECEPT Bituminous</th>
        <th>PennDot Concrete</th>
        <th>ACI Concrete</th>
      </thead>
      <tbody>
      <tr>
        <td>{{inspector.nicet_expiration}}</td>
        <td>{{inspector.penndot_bituminous}}</td>
        <td>{{inspector.necept_bituminous}}</td>
        <td>{{inspector.penndot_concrete}}</td>
        <td>{{inspector.aci_concrete}}</td>
      </tr>
    </tbody>
    </table>
</div>

<div id="work-history" class="">
  <h2>Work History</h2>
  <table id="history-table">
    <thead>
      <th>Project</th>
      <th>Duration</th>
      <th>Start Date</th>
      <th>End Date</th>
    </thead>
    <tbody>
      {% for story in history %}
      <tr>
      <td>{{story.job.prudent_number}}</td>
      <td>{{story.duration|floatformat:1}} years </td>
      <td>{{story.start_date}}</td>
      <td>{{story.stop_date}}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
<h2> Notes on {{ inspector.first_name }}: </h2>
<div class="table-responsive">
  <table class="table">
    <thead>
      <th>Author</th>
      <th>Note</th>
  {% for note in notes %}
    <tr>
      <td>[{{note.created_at}}] {{note.creator.first_name}}:</td>
      <td><strong>{{note.body}}</strong><td>
    <tr>
  {% endfor %}
{% endif %}


{% endblock %}
{% block script %}
  $(document).ready(function() {
    $('#history-table').DataTable({
      "pageLength": 5,
      "lengthChange": false
    });
} );
{% endblock %}